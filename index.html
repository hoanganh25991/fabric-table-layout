<!DOCTYPE html>
<html>
<head>
    <title>fabric</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="public/css/style.css">
    <style>
        .canvas-container {
            width: 500px;
        }
    </style>
</head>
<body>
<div class="container">
    <div id="tinker" class="row">
        <div class="col-md-4">
            <h4>load table from server url</h4>
            <input v-model="url" style="width: 100%">
            <table-info
                    :selected-layout.sync="selectedLayout"
                    :selected-table.sync="selectedTable"
                    :export-layouts-count.sync="exportLayoutsCount"
                    :layouts="layouts"
                    :table-event="tableEvent"
                    @new-table-name="handleNewTableName"
                    @broadcast-export-layouts="broadcastExportLayouts"
            >
            </table-info>
        </div>
        <div class="col-md-8">
            <div class="row">
                <div class="col-md-10">
                    <layout-info
                            :selected-layout.sync="selectedLayout"
                            :layout="layout"
                            :layouts="layouts"
                            v-for="layout in layouts"
                    >
                    </layout-info>
                </div>
                <div class="col-md-2">
                    <button @click="askLayoutName">+</button>
                </div>
            </div>
            <div v-show="askLayoutNameDivShowed">
                <input type="text" name="newLayoutName" autofocus @keyup.enter="getLayoutName">
                <button @click="getLayoutName">ok</button>
            </div>
            <layout-table
                    :selected-layout.sync="selectedLayout"
                    :selected-table.sync="selectedTable"
                    :layout="layout" v-for="layout in layouts"
                    :export-layouts-count.sync="exportLayoutsCount"
                    :layouts="layouts"
                    :table-event="tableEvent"
                    @broadcast-table-on-scaling="broadcastTableOnScaling"
                    @broadcast-table-selected="broadcastTableSelected"
                    @broadcast-table-on-rotating="broadcastTableOnRotating"
                    @layout-export-success="handleLayoutExportSuccess"
            >
            </layout-table>
        </div>
    </div>

    <template id="table-info-template">
        <p>{{ name }}</p>
        <div class="row">
            <div class="col-md-4">Rotation</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-4">-</div>
                    <div class="col-md-4">{{ rotation }}</div>
                    <div class="col-md-4">+</div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">Top/Y</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-4">-</div>
                    <div class="col-md-4">{{ top }}</div>
                    <div class="col-md-4">+</div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">Left/X</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-4">-</div>
                    <div class="col-md-4">{{ left }}</div>
                    <div class="col-md-4">+</div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">Width</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-4">-</div>
                    <div class="col-md-4">{{ width }}</div>
                    <div class="col-md-4">+</div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">Height</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-4">-</div>
                    <div class="col-md-4">{{ height }}</div>
                    <div class="col-md-4">+</div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">Shape</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-6">Rect</div>
                    <div class="col-md-6">Circle</div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">Status</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-6">Enable</div>
                    <div class="col-md-6">Disable</div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-4">Action</div>
            <div class="col-md-8">
                <div class="row">
                    <div class="col-md-6">Rename</div>
                    <div class="col-md-6">Delete</div>
                </div>
            </div>
        </div>
        <button @click="askTableName">+ add table</button>
        <button>return</button>
        <div v-show="askTableNameDivShowed">
            <input type="text" name="newTableName" autofocus @keyup.enter="getTableName">
            <button @click="getTableName">ok</button>
        </div>
        <button @click="exportLayouts">share</button>
        <div v-show="exportLayoutsDivShowed">
            <p>{{ exportLayoutsCount }} / {{ layoutsCount }}</p>
        </div>
    </template>

    <template id="layout-info-template">
		<span
                :class='{"layout-info-active": active}'
                @click="setSelectedLayout"
        >{{ name }}
		</span>
    </template>

    <template id="layout-table-template">
        <div v-show="active" class="canvas-container">
            <h1>{{ name }}</h1>
            <canvas id="{{ id }}" v-el:canvas class="layout-table-active"></canvas>
        </div>
    </template>

</div>
<script src="public/js/fabric.min.js"></script>
<script src="public/js/main.js"></script>
</body>
</html>